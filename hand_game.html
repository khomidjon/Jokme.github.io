<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>ALCHEMIST - Kimyo Magnati</title>
    <style>
        body {
            margin: 0;
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Consolas', 'Courier New', monospace;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* 1. CHAP TOMON - DO'KON */
        #shop-panel {
            width: 250px;
            background: #1e1e24;
            border-right: 1px solid #333;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        .panel-title {
            color: #ff9800;
            font-size: 18px;
            border-bottom: 2px solid #ff9800;
            margin-bottom: 15px;
            padding-bottom: 5px;
            text-transform: uppercase;
        }
        .shop-item {
            display: flex;
            justify-content: space-between;
            background: #2b2b36;
            padding: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            border-radius: 4px;
            transition: 0.2s;
        }
        .shop-item:hover { background: #3a3a48; color: #ff9800; }
        .price-tag { color: #00e676; font-weight: bold; }

        /* 2. O'RTA - ISH STOLI */
        #workspace {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            position: relative;
        }
        
        #target-display {
            background: #212121;
            border: 2px solid #00e676;
            padding: 15px 30px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            width: 80%;
            box-shadow: 0 0 15px rgba(0, 230, 118, 0.2);
        }
        #money-cnt { font-size: 24px; color: #ffd700; margin-bottom: 10px; font-weight: bold; }

        /* KOLBA */
        #mixing-flask {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            border: 4px solid rgba(255,255,255,0.2);
            background: radial-gradient(circle, #333, #121212);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }
        .flask-substance {
            background: rgba(255,255,255,0.1);
            padding: 5px 10px;
            margin: 2px;
            border-radius: 4px;
            font-size: 14px;
        }

        /* TUGMALAR */
        .action-btn {
            padding: 12px 30px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: 0.3s;
        }
        .btn-react { background: #2979ff; color: white; }
        .btn-react:hover { background: #2962ff; box-shadow: 0 0 15px #2979ff; }
        .btn-clear { background: #d32f2f; color: white; }
        .btn-sell { background: #00c853; color: white; display: none; } /* Sotish tugmasi yashirin */

        /* LOG (Tarix) */
        #reaction-log {
            width: 90%;
            height: 200px;
            background: #000;
            border: 1px solid #333;
            overflow-y: auto;
            padding: 10px;
            font-family: monospace;
            color: #00ff00;
            margin-top: auto; /* Pastga tushirish */
            border-radius: 5px;
        }
        .log-entry { margin-bottom: 5px; border-bottom: 1px solid #222; padding-bottom: 2px; }

        /* 3. O'NG TOMON - MENING MODDALARIM */
        #inventory-panel {
            width: 250px;
            background: #1e1e24;
            border-left: 1px solid #333;
            padding: 15px;
            overflow-y: auto;
        }
        .inv-item {
            background: #2b2b36;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            border-left: 3px solid #2979ff;
        }
        .inv-item:hover { background: #3a3a48; transform: translateX(-5px); }
        .inv-qty { background: #444; padding: 2px 6px; border-radius: 10px; font-size: 12px; }

    </style>
</head>
<body>

    <div id="shop-panel">
        <div class="panel-title">üõí REAKTIVLAR DO'KONI</div>
        <div id="shop-list">
            </div>
    </div>

    <div id="workspace">
        <div id="money-cnt">Hamyon: $100</div>
        
        <div id="target-display">
            <div>BUYURTMA:</div>
            <h2 id="quest-target" style="color: #ff4081; margin: 5px 0;">Metan (CH4)</h2>
            <div id="quest-reward" style="color: #00e676;">Mukofot: $300</div>
            <button id="btn-submit-quest" class="action-btn btn-sell" onclick="submitQuest()">TOPSHIRISH</button>
        </div>

        <div id="mixing-flask" title="Moddalarni shu yerga qo'shing">
            </div>

        <div>
            <button class="action-btn btn-clear" onclick="clearFlask()">TOZALASH</button>
            <button class="action-btn btn-react" onclick="startReaction()">REAKSIYA QILISH ‚öóÔ∏è</button>
        </div>

        <h3>REAKSIYALAR TARIXI:</h3>
        <div id="reaction-log">
            <div class="log-entry">> Tizim tayyor...</div>
        </div>
    </div>

    <div id="inventory-panel">
        <div class="panel-title">üéí MENING MODDALARIM</div>
        <div id="my-inventory">
            </div>
    </div>

    <script>
        // -------------------------------------------------------------
        // MA'LUMOTLAR BAZASI
        // -------------------------------------------------------------
        
        // Barcha moddalar (Nomi va formulasi)
        const substances = {
            'H2': { name: 'Vodorod', type: 'elem' },
            'O2': { name: 'Kislorod', type: 'elem' },
            'C': { name: 'Uglerod', type: 'elem' },
            'Na': { name: 'Natriy', type: 'elem' },
            'Cl2': { name: 'Xlor', type: 'elem' },
            'Al': { name: 'Alyuminiy', type: 'elem' },
            'N2': { name: 'Azot', type: 'elem' },
            // Murakkab
            'H2O': { name: 'Suv', type: 'comp' },
            'CO2': { name: 'Karbonat Angidrid', type: 'comp' },
            'NaCl': { name: 'Osh Tuzi', type: 'comp' },
            'Al4C3': { name: 'Alyuminiy Karbid', type: 'comp' },
            'CH4': { name: 'Metan', type: 'comp' },
            'Al(OH)3': { name: 'Alyuminiy Gidroksid', type: 'comp' },
            'NH3': { name: 'Ammiak', type: 'comp' }, // Sotib olinadigan qiyin modda
            'HCl': { name: 'Xlorid Kislota', type: 'comp' }
        };

        // Do'kon (Nimalarni sotib olsa bo'ladi)
        const shopItems = [
            { id: 'H2', price: 10 },
            { id: 'O2', price: 10 },
            { id: 'C', price: 15 },
            { id: 'Na', price: 20 },
            { id: 'Cl2', price: 20 },
            { id: 'Al', price: 25 },
            { id: 'Al4C3', price: 150 }, // Qimmat reaktiv
            { id: 'NH3', price: 100 },   // Sotib olinadigan tayyor
        ];

        // Reaksiyalar kitobi (Tenglamalar bilan)
        const reactions = [
            { inputs: ['H2', 'O2'], outputs: ['H2O'], equation: '2H‚ÇÇ + O‚ÇÇ ‚Üí 2H‚ÇÇO' },
            { inputs: ['Na', 'Cl2'], outputs: ['NaCl'], equation: '2Na + Cl‚ÇÇ ‚Üí 2NaCl' },
            { inputs: ['C', 'O2'], outputs: ['CO2'], equation: 'C + O‚ÇÇ ‚Üí CO‚ÇÇ' },
            { inputs: ['H2', 'Cl2'], outputs: ['HCl'], equation: 'H‚ÇÇ + Cl‚ÇÇ ‚Üí 2HCl' },
            // Siz so'ragan murakkab reaksiya
            { inputs: ['Al4C3', 'H2O'], outputs: ['CH4', 'Al(OH)3'], equation: 'Al‚ÇÑC‚ÇÉ + 12H‚ÇÇO ‚Üí 3CH‚ÇÑ + 4Al(OH)‚ÇÉ' },
            // Murakkabroq
            { inputs: ['NH3', 'HCl'], outputs: ['NH4Cl'], equation: 'NH‚ÇÉ + HCl ‚Üí NH‚ÇÑCl' }
        ];

        // -------------------------------------------------------------
        // O'YIN STATE (HOLATI)
        // -------------------------------------------------------------
        let money = 200;
        let inventory = {}; // { 'H2': 5, 'O2': 2 } kabi saqlaydi
        let flask = [];     // Hozirgi aralashma
        let currentQuest = { id: 'CH4', reward: 500 };

        // -------------------------------------------------------------
        // FUNKSIYALAR
        // -------------------------------------------------------------

        function init() {
            renderShop();
            renderInventory();
            updateUI();
        }

        // 1. DO'KONNI CHIZISH
        function renderShop() {
            const list = document.getElementById('shop-list');
            list.innerHTML = '';
            shopItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'shop-item';
                div.innerHTML = `
                    <span>${substances[item.id].name} (${item.id})</span>
                    <span class="price-tag">$${item.price}</span>
                `;
                div.onclick = () => buyItem(item.id, item.price);
                list.appendChild(div);
            });
        }

        // Sotib olish
        function buyItem(id, price) {
            if (money >= price) {
                money -= price;
                addToInventory(id, 1);
                updateUI();
                log(`Sotib olindi: ${substances[id].name}`, '#ff9800');
            } else {
                alert("Pulingiz yetmaydi!");
            }
        }

        // 2. OMBORNI CHIZISH
        function renderInventory() {
            const list = document.getElementById('my-inventory');
            list.innerHTML = '';
            
            for (const [id, qty] of Object.entries(inventory)) {
                if (qty > 0) {
                    const div = document.createElement('div');
                    div.className = 'inv-item';
                    div.innerHTML = `
                        <span>${id}</span>
                        <span class="inv-qty">x${qty}</span>
                    `;
                    div.onclick = () => addToFlask(id);
                    list.appendChild(div);
                }
            }
        }

        // Ombordagi narsani kolbaga solish
        function addToFlask(id) {
            if (inventory[id] > 0) {
                if(flask.length >= 2) {
                    alert("Kolbaga faqat 2 xil modda sig'adi!");
                    return;
                }
                inventory[id]--; // Ombordan kamayadi
                flask.push(id);
                renderInventory();
                renderFlask();
            }
        }

        function renderFlask() {
            const container = document.getElementById('mixing-flask');
            container.innerHTML = '';
            flask.forEach(id => {
                const div = document.createElement('div');
                div.className = 'flask-substance';
                div.innerText = `${substances[id].name} (${id})`;
                container.appendChild(div);
            });
        }

        function clearFlask() {
            // Narsalarni omborga qaytarish
            flask.forEach(id => {
                addToInventory(id, 1);
            });
            flask = [];
            renderFlask();
        }

        function addToInventory(id, qty) {
            if (!inventory[id]) inventory[id] = 0;
            inventory[id] += qty;
            renderInventory();
        }

        // 3. REAKSIYA MANTIG'I
        function startReaction() {
            if (flask.length < 2) {
                log("Reaksiya uchun kamida 2 ta modda kerak.", "red");
                return;
            }

            const input1 = flask[0];
            const input2 = flask[1];

            // Reaksiyani qidirish
            let foundReaction = reactions.find(r => {
                return (r.inputs.includes(input1) && r.inputs.includes(input2));
            });

            if (foundReaction) {
                // Reaksiya muvaffaqiyatli!
                log(`REAKSIYA KETDI: ${foundReaction.equation}`, "#00e676");
                
                // Natijalarni omborga qo'shish
                foundReaction.outputs.forEach(out => {
                    addToInventory(out, 1); // 1 birlikdan qo'shiladi
                    log(`Hosil bo'ldi: ${substances[out].name} (${out})`, "#fff");
                });

                flask = []; // Kolba bo'shadi (reaksiya tugadi)
                renderFlask();
                checkQuest(); // Buyurtma tayyor bo'ldimi?

            } else {
                // Reaksiya yo'q
                log(`Xatolik: ${input1} va ${input2} reaksiyaga kirishmaydi!`, "red");
                // Moddalar qaytarib beriladi (portlamadi deb hisoblaymiz)
                clearFlask();
            }
        }

        // 4. LOG (Tarix) yozish
        function log(text, color = "#00ff00") {
            const container = document.getElementById('reaction-log');
            const div = document.createElement('div');
            div.className = 'log-entry';
            div.style.color = color;
            div.innerText = `> ${text}`;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight; // Avto scroll
        }

        function updateUI() {
            document.getElementById('money-cnt').innerText = `Hamyon: $${money}`;
            
            // Buyurtmani tekshirish
            const submitBtn = document.getElementById('btn-submit-quest');
            if (inventory[currentQuest.id] > 0) {
                submitBtn.style.display = 'inline-block';
            } else {
                submitBtn.style.display = 'none';
            }
        }

        function checkQuest() {
            updateUI();
        }

        // Buyurtmani topshirish
        function submitQuest() {
            if (inventory[currentQuest.id] > 0) {
                inventory[currentQuest.id]--; // Moddani olib qo'yamiz
                money += currentQuest.reward;
                log(`BUYURTMA BAJARILDI! +$${currentQuest.reward}`, "yellow");
                
                // Yangi random buyurtma
                generateNewQuest();
                renderInventory();
                updateUI();
            }
        }

        function generateNewQuest() {
            const possibleQuests = [
                { id: 'H2O', reward: 50, name: 'Suv' },
                { id: 'NaCl', reward: 80, name: 'Osh Tuzi' },
                { id: 'CO2', reward: 60, name: 'Karbonat Angidrid' },
                { id: 'CH4', reward: 500, name: 'Metan' },
                { id: 'Al(OH)3', reward: 300, name: 'Alyuminiy Gidroksid' },
                { id: 'HCl', reward: 120, name: 'Kislota' }
            ];
            
            const random = possibleQuests[Math.floor(Math.random() * possibleQuests.length)];
            currentQuest = random;
            
            document.getElementById('quest-target').innerText = `${random.name} (${random.id})`;
            document.getElementById('quest-reward').innerText = `Mukofot: $${random.reward}`;
        }

        // Boshlash
        init();

    </script>
</body>
</html>
