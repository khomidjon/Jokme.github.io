<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>ALCHEMIST</title>
    <style>
        body {
            margin: 0;
            background-color: #181818;
            color: #e0e0e0;
            font-family: 'Segoe UI', monospace;
            display: flex;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* CHAP - DO'KON */
        #shop-panel {
            width: 260px;
            background: #202028;
            border-right: 2px solid #333;
            padding: 10px;
            overflow-y: auto;
        }
        .panel-header {
            color: #ff9800;
            font-size: 20px;
            text-align: center;
            border-bottom: 2px solid #ff9800;
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #2d2d38;
            padding: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            border-radius: 6px;
            border: 1px solid transparent;
            transition: 0.2s;
        }
        .shop-item:hover { border-color: #ff9800; background: #383845; }
        .price { color: #00e676; font-weight: bold; }

        /* O'RTA - LABORATORIYA */
        #lab-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            background: radial-gradient(circle at center, #2a2a35 0%, #181818 100%);
        }
        
        /* TOP PANEL (PUL & BUYURTMA) */
        #top-bar {
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 20px;
            font-size: 24px;
            font-weight: bold;
            background: rgba(0,0,0,0.3);
        }
        #money { color: #ffd700; text-shadow: 0 0 10px #ffd700; }

        /* BUYURTMA EKRANI */
        #quest-card {
            background: rgba(0, 0, 0, 0.6);
            border: 2px solid #00e676;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 10px;
            width: 60%;
            position: relative;
        }
        #quest-name { font-size: 28px; color: #ff4081; font-weight: bold; margin: 10px 0; }
        
        /* YORDAM TUGMASI */
        #hint-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ffd700;
            color: black;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 10px yellow;
        }
        #hint-box {
            display: none;
            margin-top: 10px;
            color: #ffd700;
            font-size: 14px;
            font-style: italic;
        }

        /* KOLBA */
        #flask-container {
            position: relative;
            width: 220px;
            height: 220px;
            margin: 30px 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #flask {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 5px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            transition: 0.3s;
        }
        /* Olov effekti */
        #fire-effect {
            position: absolute; bottom: -20px; width: 100%; height: 50px;
            background: linear-gradient(to top, red, orange, transparent);
            opacity: 0; transition: 0.5s; filter: blur(5px);
        }

        .substance-badge {
            background: rgba(0,0,0,0.6);
            border: 1px solid #555;
            padding: 5px 10px;
            margin: 2px;
            border-radius: 4px;
            font-size: 14px;
        }

        /* TUGMALAR PANELI */
        #controls { display: flex; gap: 15px; }
        .btn {
            padding: 15px 25px;
            font-size: 18px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: white;
            transition: 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .btn:active { transform: translateY(2px); }
        
        .btn-mix { background: linear-gradient(45deg, #2196f3, #21cbf3); } /* Ko'k */
        .btn-burn { background: linear-gradient(45deg, #ff5722, #ff9100); } /* Olovrang */
        .btn-clear { background: #d32f2f; }
        .btn-submit { background: #00c853; display: none; }

        /* LOG */
        #log-area {
            width: 80%;
            height: 150px;
            background: #111;
            border-top: 2px solid #444;
            margin-top: auto;
            padding: 10px;
            font-family: 'Courier New', monospace;
            overflow-y: auto;
            color: #aaa;
        }
        .log-success { color: #00e676; }
        .log-fail { color: #ff5252; }
        .log-info { color: #29b6f6; }

        /* O'NG - OMBOR */
        #inventory-panel {
            width: 260px;
            background: #202028;
            border-left: 2px solid #333;
            padding: 10px;
        }
        .inv-item {
            background: #2d2d38;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            border-left: 3px solid #2196f3;
        }
        .inv-item:hover { background: #383845; transform: translateX(-5px); }

    </style>
</head>
<body>

    <div id="shop-panel">
        <div class="panel-header">ðŸ›’ REAKTIVLAR</div>
        <div id="shop-list"></div>
    </div>

    <div id="lab-area">
        <div id="top-bar">
            <span>Kimyogar Simulator</span>
            <span id="money">ðŸ’° $200</span>
        </div>

        <div id="quest-card">
            <button id="hint-btn" onclick="showHint()" title="Yordam">?</button>
            <div style="font-size: 14px; color: #aaa;">MIJOZ BUYURTMASI:</div>
            <div id="quest-name">...</div>
            <div id="quest-reward" style="color: #00e676; font-weight: bold;"></div>
            <div id="hint-box"></div>
            <button class="btn btn-submit" id="submit-btn" onclick="submitQuest()">TOPSHIRISH ($$$)</button>
        </div>

        <div id="flask-container">
            <div id="flask">
                </div>
            <div id="fire-effect"></div>
        </div>

        <div id="controls">
            <button class="btn btn-clear" onclick="clearFlask()">TOZALASH</button>
            <button class="btn btn-mix" onclick="react('mix')">ARALASHTIRISH ðŸ’§</button>
            <button class="btn btn-burn" onclick="react('heat')">QIZDIRISH (YOQISH) ðŸ”¥</button>
        </div>

        <div id="log-area">
            <div>> Laboratoriya tayyor. Ishni boshlang...</div>
        </div>
    </div>

    <div id="inventory-panel">
        <div class="panel-header">ðŸŽ’ OMBOR</div>
        <div id="inventory-list"></div>
    </div>

    <script>
        // -----------------------------------------------------------
        // 1. DATA (MODDALAR VA REAKSIYALAR)
        // -----------------------------------------------------------
        const substances = {
            // Elementlar
            'H2': { name: 'Vodorod', type: 'gas' },
            'O2': { name: 'Kislorod', type: 'gas' },
            'C': { name: 'Uglerod (Ko\'mir)', type: 'solid' },
            'Na': { name: 'Natriy', type: 'solid' },
            'Cl2': { name: 'Xlor', type: 'gas' },
            'S': { name: 'Oltingugurt', type: 'solid' },
            'Fe': { name: 'Temir', type: 'solid' },
            'Al': { name: 'Alyuminiy', type: 'solid' },
            'Ca': { name: 'Kalsiy', type: 'solid' },
            
            // Murakkab
            'H2O': { name: 'Suv', type: 'liquid' },
            'CO2': { name: 'Karbonat Angidrid', type: 'gas' },
            'NaCl': { name: 'Osh Tuzi', type: 'solid' },
            'FeS': { name: 'Temir Sulfid', type: 'solid' },
            'SO2': { name: 'Sulfat Angidrid', type: 'gas' },
            'CaO': { name: 'So\'ndirilmagan Ohak', type: 'solid' },
            'Ca(OH)2': { name: 'Ohakli Suv', type: 'liquid' },
            'Al4C3': { name: 'Alyuminiy Karbid', type: 'solid' }, // Qimmat
            'CH4': { name: 'Metan', type: 'gas' },
            'Al(OH)3': { name: 'Alyuminiy Gidroksid', type: 'solid' },
            'HCl': { name: 'Xlorid Kislota', type: 'liquid' },
            'H2SO4': { name: 'Sulfat Kislota', type: 'liquid' },
            'Fe2O3': { name: 'Temir Oksidi (Zang)', type: 'solid' }
        };

        const shopItems = [
            { id: 'H2', price: 5 },
            { id: 'O2', price: 5 },
            { id: 'C', price: 10 },
            { id: 'Na', price: 15 },
            { id: 'Cl2', price: 15 },
            { id: 'S', price: 20 },
            { id: 'Fe', price: 25 },
            { id: 'Al', price: 30 },
            { id: 'Ca', price: 30 },
            { id: 'Al4C3', price: 150 }, // Maxsus
        ];

        // REAKSIYALAR KITOBI
        // type: 'mix' (shunchaki qo'shish) yoki 'heat' (olovda yoqish)
        const reactions = [
            // Aralashtirish (Mix)
            { inputs: ['H2', 'O2'], output: ['H2O'], type: 'mix', eq: '2Hâ‚‚ + Oâ‚‚ â†’ 2Hâ‚‚O (Portlash!)' }, // Aslida olov kerak, lekin o'yin uchun mix ham bo'ladi
            { inputs: ['Na', 'Cl2'], output: ['NaCl'], type: 'mix', eq: '2Na + Clâ‚‚ â†’ 2NaCl' },
            { inputs: ['Ca', 'H2O'], output: ['Ca(OH)2', 'H2'], type: 'mix', eq: 'Ca + 2Hâ‚‚O â†’ Ca(OH)â‚‚ + Hâ‚‚' },
            { inputs: ['CaO', 'H2O'], output: ['Ca(OH)2'], type: 'mix', eq: 'CaO + Hâ‚‚O â†’ Ca(OH)â‚‚' },
            { inputs: ['Al4C3', 'H2O'], output: ['CH4', 'Al(OH)3'], type: 'mix', eq: 'Alâ‚„Câ‚ƒ + 12Hâ‚‚O â†’ 3CHâ‚„ + 4Al(OH)â‚ƒ' },
            { inputs: ['SO2', 'H2O'], output: ['H2SO3'], type: 'mix', eq: 'SOâ‚‚ + Hâ‚‚O â†’ Hâ‚‚SOâ‚ƒ' },

            // Qizdirish / Yoqish (Heat)
            { inputs: ['C', 'O2'], output: ['CO2'], type: 'heat', eq: 'C + Oâ‚‚ â†’(t) COâ‚‚ (Yonish)' },
            { inputs: ['S', 'O2'], output: ['SO2'], type: 'heat', eq: 'S + Oâ‚‚ â†’(t) SOâ‚‚' },
            { inputs: ['Fe', 'S'], output: ['FeS'], type: 'heat', eq: 'Fe + S â†’(t) FeS' },
            { inputs: ['Ca', 'O2'], output: ['CaO'], type: 'heat', eq: '2Ca + Oâ‚‚ â†’(t) 2CaO' },
            { inputs: ['CH4', 'O2'], output: ['CO2', 'H2O'], type: 'heat', eq: 'CHâ‚„ + 2Oâ‚‚ â†’(t) COâ‚‚ + 2Hâ‚‚O' },
            { inputs: ['Fe', 'O2'], output: ['Fe2O3'], type: 'heat', eq: '4Fe + 3Oâ‚‚ â†’(t) 2Feâ‚‚Oâ‚ƒ' }
        ];

        // -----------------------------------------------------------
        // 2. O'YIN MANTIG'I
        // -----------------------------------------------------------
        let money = 200;
        let inventory = {};
        let flask = [];
        let currentQuest = null;

        // Boshlash
        window.onload = () => {
            renderShop();
            renderInventory();
            newQuest();
        };

        // --- DO'KON ---
        function renderShop() {
            const list = document.getElementById('shop-list');
            list.innerHTML = '';
            shopItems.forEach(item => {
                const el = document.createElement('div');
                el.className = 'shop-item';
                el.innerHTML = `<span>${substances[item.id].name}</span> <span class="price">$${item.price}</span>`;
                el.onclick = () => buy(item.id, item.price);
                list.appendChild(el);
            });
        }

        function buy(id, price) {
            if (money >= price) {
                money -= price;
                updateMoney();
                addItem(id, 1);
                log(`Sotib olindi: ${substances[id].name}`, 'log-info');
            } else {
                alert("Pulingiz yetmaydi!");
            }
        }

        // --- OMBOR & KOLBA ---
        function renderInventory() {
            const list = document.getElementById('inventory-list');
            list.innerHTML = '';
            for (let [id, qty] of Object.entries(inventory)) {
                if (qty > 0) {
                    const el = document.createElement('div');
                    el.className = 'inv-item';
                    el.innerHTML = `<span>${substances[id].name} (${id})</span> <span>x${qty}</span>`;
                    el.onclick = () => addToFlask(id);
                    list.appendChild(el);
                }
            }
        }

        function addToFlask(id) {
            if (flask.length >= 2) {
                alert("Kolbaga faqat 2 ta modda sig'adi!");
                return;
            }
            if (inventory[id] > 0) {
                inventory[id]--;
                flask.push(id);
                renderInventory();
                renderFlask();
            }
        }

        function renderFlask() {
            const container = document.getElementById('flask');
            container.innerHTML = '';
            flask.forEach(id => {
                const el = document.createElement('div');
                el.className = 'substance-badge';
                el.innerText = id;
                container.appendChild(el);
            });
        }

        function clearFlask() {
            flask.forEach(id => addItem(id, 1));
            flask = [];
            renderFlask();
            document.getElementById('hint-box').style.display = 'none';
        }

        function addItem(id, qty) {
            inventory[id] = (inventory[id] || 0) + qty;
            renderInventory();
            checkQuest();
        }

        // --- REAKSIYA ---
        function react(type) {
            if (flask.length < 2) {
                log("Reaksiya uchun 2 ta modda kerak!", 'log-fail');
                return;
            }

            // Olov animatsiyasi
            if (type === 'heat') {
                const fire = document.getElementById('fire-effect');
                fire.style.opacity = 1;
                setTimeout(() => fire.style.opacity = 0, 1000);
            }

            const input1 = flask[0];
            const input2 = flask[1];

            // Retsept qidirish
            const recipe = reactions.find(r => 
                r.inputs.includes(input1) && 
                r.inputs.includes(input2) && 
                r.type === type // Turi to'g'ri kelishi kerak (mix yoki heat)
            );

            if (recipe) {
                log(`REAKSIYA: ${recipe.eq}`, 'log-success');
                recipe.output.forEach(out => {
                    addItem(out, 1);
                    log(`+ Hosil bo'ldi: ${substances[out].name}`, 'log-info');
                });
                flask = [];
                renderFlask();
            } else {
                // Agar noto'g'ri bo'lsa
                if (type === 'heat') log(`${input1} va ${input2} yondirildi, lekin natija yo'q... (Kuyib ketdi)`, 'log-fail');
                else log(`${input1} va ${input2} aralashmadi.`, 'log-fail');
                
                // Noto'g'ri reaksiyada moddalar yo'qoladi (jazo)
                flask = [];
                renderFlask();
            }
        }

        // --- BUYURTMA & YORDAM ---
        function newQuest() {
            const quests = [
                { id: 'H2O', reward: 50 },
                { id: 'NaCl', reward: 80 },
                { id: 'CO2', reward: 60 },
                { id: 'FeS', reward: 100 },
                { id: 'Ca(OH)2', reward: 120 },
                { id: 'CH4', reward: 500 }, // Jekpot
                { id: 'Fe2O3', reward: 150 }
            ];
            currentQuest = quests[Math.floor(Math.random() * quests.length)];
            
            document.getElementById('quest-name').innerText = `${substances[currentQuest.id].name} (${currentQuest.id})`;
            document.getElementById('quest-reward').innerText = `Mukofot: $${currentQuest.reward}`;
            document.getElementById('submit-btn').style.display = 'none';
            document.getElementById('hint-box').style.display = 'none';
            checkQuest();
        }

        function checkQuest() {
            if (inventory[currentQuest.id] > 0) {
                document.getElementById('submit-btn').style.display = 'inline-block';
            }
        }

        function submitQuest() {
            if (inventory[currentQuest.id] > 0) {
                inventory[currentQuest.id]--;
                money += currentQuest.reward;
                updateMoney();
                log(`BUYURTMA TOPSHIRILDI! +$${currentQuest.reward}`, 'log-success');
                renderInventory();
                newQuest();
            }
        }

        function showHint() {
            const box = document.getElementById('hint-box');
            // Qidirilayotgan modda uchun retsept topish
            const recipe = reactions.find(r => r.output.includes(currentQuest.id));
            
            if (recipe) {
                let method = recipe.type === 'heat' ? "ðŸ”¥ QIZDIRISH" : "ðŸ’§ ARALASHTIRISH";
                let in1 = substances[recipe.inputs[0]].name;
                let in2 = substances[recipe.inputs[1]].name;
                box.innerText = `Retsept: ${in1} + ${in2} -> [${method}]`;
                box.style.display = 'block';
            } else {
                box.innerText = "Bu moddani do'kondan tayyorini topa olmaysiz, reaksiyalarni sinab ko'ring!";
                box.style.display = 'block';
            }
        }

        function log(msg, cls) {
            const area = document.getElementById('log-area');
            area.innerHTML += `<div class="${cls}">> ${msg}</div>`;
            area.scrollTop = area.scrollHeight;
        }

        function updateMoney() {
            document.getElementById('money').innerText = `ðŸ’° $${money}`;
        }

    </script>
</body>
</html>
